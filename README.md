# Инструкция по работе с расписанием в Google Таблице и скриптом Google Apps Script

## Назначение

Этот шаблон Google Таблицы используется для создания и управления расписанием недели с возможностью автоматического добавления событий в Google Календарь. Автоматизация осуществляется с помощью Google Apps Script. Расписание можно просматривать, а уведомления получать через Telegram-бота.

---

## Как работает интеграция

1. **Заполняете таблицу расписания** по определённому шаблону (см. ниже).
2. **Запускаете скрипт** Google Apps Script, который переносит активные события в Google Календарь.
3. **Уведомления и напоминания** о событиях рассылает Telegram-бот (если подключён).

---

## Структура таблицы

Таблица содержит строки и столбцы со следующими полями (пример ниже):

| № | День недели   | Время начала | Время конца | Описание события     | Категория       | Цвет   | ... | Статус  |
|---|--------------|--------------|-------------|----------------------|-----------------|--------|-----|---------|
| 1 | понедельник  | 09:00        | 10:30       | Планёрка             | Встречи         | BLUE   | ... | активно |
| 2 | вторник      | 11:00        | 12:00       | Работа с документами | Самостоятельная | GREEN  | ... | активно |
| 3 | среда        | 19:30        | 21:00       | Тренировка           | Спорт           | RED    | ... | активно |
|...| ...          | ...          | ...         | ...                  | ...             | ...    | ... | ...     |

**Внимание:** Названия столбцов могут отличаться, но порядок и наличие обязательных столбцов важно для работы скрипта!

---

### Описание полей

- **День недели** (обязательно):  
  Пишите полностью на русском, строчными буквами, например: `понедельник`, `вторник`, ...  
  Скрипт поддерживает только русские названия!

- **Время начала** и **Время конца** (обязательно):  
  Формат времени: `чч:мм` (например, `09:00`). Можно копировать как время из Google Таблицы.

- **Описание события**:  
  Краткое название события, будет видно в календаре.

- **Категория** (необязательно):  
  Например: `Встреча`, `Работа`, `Спорт` и др. Будет отображаться в описании события календаря.

- **Цвет** (опционально):  
  Цвет для события. Поддерживаются стандартные цвета Google Календаря — указывайте латинскими заглавными буквами:  
  `BLUE`, `GREEN`, `RED`, `YELLOW`, `ORANGE`, `PURPLE`, `PINK`, `TURQUOISE`, `GRAY`.

- **Статус** (обязательно):  
  Для активации события в календаре напишите **"активно"** (без кавычек). Все остальные значения — событие игнорируется.

- **Дополнительные столбцы** (по желанию):  
  Можно добавить, но скрипт их не обрабатывает.

---

## Как заполнить таблицу

1. Откройте таблицу Google (например, по шаблону или ссылке).
2. Добавьте новые строки для каждого события недели.
3. Заполните столбцы в соответствии с описанием выше.
4. Убедитесь, что **статус** = `активно` только у тех событий, которые должны попасть в календарь.

---

## Как запустить скрипт

1. Откройте Google Таблицу → `Расширения` → `Apps Script`.
2. Вставьте или откройте код скрипта `addScheduleToCalendar.gs`.
3. Нажмите кнопку ▶ (Выполнить/Run).
4. Разрешите доступ к Google Календарю, если скрипт запущен впервые.
5. Дождитесь завершения выполнения — события недели добавятся в календарь.

**Примечание:** Перед запуском скрипта все события текущей недели в календаре будут удалены и перезаписаны.

---

## Как изменить календарь

- В скрипте есть строка  
  ```js
  var calendarId = 'your_calendar_id@group.calendar.google.com';

---

## Если вы используете свой календарь — замените calendarId на идентификатор вашего календаря.

Примечания:

1. Для корректной работы обязательно используйте русские дни недели.
2. Цвета событий необязательны, но их можно указывать для визуального удобства.
3. События через полночь (например, с 23:00 до 02:00) корректно поддерживаются — конец указывается в следующем дне автоматически.
4. Если событие не попало в календарь — проверьте, что поле "Статус" заполнено как активно.

---

## Вопросы и поддержка
Если возникли сложности или вопросы:

1. Проверьте, что таблица и скрипт находятся в одной и той же Google-учётке.
2. Убедитесь, что вы разрешили доступ к Google Календарю при первом запуске скрипта.
3. Для дополнительных вопросов — обратитесь к вашему администратору или разработчику бота.


